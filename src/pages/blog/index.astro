---
import Layout from '../../layouts/Layout.astro';
import SearchInput from '../../components/SearchInput.astro';
import BlogCard from '../../components/BlogCard.astro';

const posts = [
  {
    title: 'Understanding Vue 3 Composition API: A Practical Guide',
    date: 'Mar 15 2024',
    tags: ['Vue.js', 'JavaScript'],
    slug: 'vue3-composition-api',
    image: '/img/blog/vue3-composition-api.svg',
  },
  {
    title: 'GraphQL Subscriptions: Real-time Data with Apollo Server',
    date: 'Nov 08 2023',
    tags: ['GraphQL', 'Node.js'],
    slug: 'graphql-subscriptions-apollo',
    image: '/img/blog/graphql-subscriptions-apollo.svg',
  },
  {
    title: 'Unlocking New Possibilities with Dart Extensions',
    date: 'Jan 17 2023',
    tags: ['Dart', 'Flutter'],
    slug: 'dart-extensions',
    image: '/img/blog/dart-extensions.svg',
  },
  {
    title: 'Mastering Flutter BLoC Pattern for State Management',
    date: 'Aug 22 2022',
    tags: ['Flutter', 'Dart'],
    slug: 'flutter-bloc-pattern',
    image: '/img/blog/flutter-bloc-pattern.svg',
  },
  {
    title: 'Real-time Communication with Socket.io and Redis',
    date: 'Mar 14 2022',
    tags: ['Node.js', 'Socket.io', 'Redis'],
    slug: 'socketio-redis-realtime',
    image: '/img/blog/socketio-redis-realtime.svg',
  },
  {
    title: '5 MongoDB Aggregation Pipeline Tips',
    date: 'Feb 28 2021',
    tags: ['MongoDB', 'Database'],
    slug: 'mongodb-aggregation-tips',
    image: '/img/blog/mongodb-aggregation-tips.svg',
  },
  {
    title: 'Exploring Goa in Golang: A Paradigm Shift in Web Development',
    date: 'May 10 2020',
    tags: ['Golang', 'Goa'],
    slug: 'exploring-goa',
    image: '/img/blog/exploring-goa.svg',
  },
  {
    title: 'Docker for Developers: From Zero to Production',
    date: 'Sep 18 2019',
    tags: ['Docker', 'DevOps'],
    slug: 'docker-for-developers',
    image: '/img/blog/docker-for-developers.svg',
  },
  {
    title: 'Building RESTful APIs with Laravel: Best Practices',
    date: 'Jul 05 2018',
    tags: ['Laravel', 'PHP'],
    slug: 'laravel-api-best-practices',
    image: '/img/blog/laravel-api-best-practices.svg',
  },
  {
    title: 'AWS S3: Tips for Efficient File Storage',
    date: 'Jan 22 2018',
    tags: ['AWS', 'Cloud'],
    slug: 'aws-s3-tips',
    image: '/img/blog/aws-s3-tips.svg',
  },
  {
    title: 'Getting Started with Augmented Reality in Unity',
    date: 'Oct 12 2016',
    tags: ['Unity', 'AR', 'Vuforia'],
    slug: 'unity-ar-basics',
    image: '/img/blog/unity-ar-basics.svg',
  },
  {
    title: 'Indoor Positioning with Bluetooth Beacons on Android',
    date: 'Nov 20 2015',
    tags: ['Android', 'Bluetooth', 'Java'],
    slug: 'android-bluetooth-beacons',
    image: '/img/blog/android-bluetooth-beacons.svg',
  },
];
---

<Layout title="Blog - Juan Estrada" currentPage="blog">
  <div class="blog-container">
    <SearchInput placeholder="Search ..." />

    <div class="blog-list" id="blog-list">
      {posts.map((post) => (
        <div
          class="blog-item"
          data-title={post.title.toLowerCase()}
          data-tags={post.tags.map(t => t.toLowerCase()).join(',')}
        >
          <BlogCard
            title={post.title}
            date={post.date}
            tags={post.tags}
            slug={post.slug}
            image={post.image}
          />
        </div>
      ))}
    </div>
  </div>
</Layout>

<style>
  .blog-container {
    max-width: 700px;
    margin: 0 auto;
  }

  .blog-list {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  .blog-item {
    display: block;
  }

  .blog-item.hidden {
    display: none;
  }
</style>

<script>
  const searchInput = document.getElementById('search-input') as HTMLInputElement;
  const blogItems = document.querySelectorAll('.blog-item');

  function filterPosts(query: string) {
    const searchTerm = query.toLowerCase().trim();

    blogItems.forEach((item) => {
      const title = item.getAttribute('data-title') || '';
      const tags = item.getAttribute('data-tags') || '';

      if (searchTerm === '') {
        item.classList.remove('hidden');
      } else {
        const matchesTitle = title.includes(searchTerm);
        const matchesTags = tags.includes(searchTerm);

        if (matchesTitle || matchesTags) {
          item.classList.remove('hidden');
        } else {
          item.classList.add('hidden');
        }
      }
    });
  }

  searchInput?.addEventListener('input', (e) => {
    const target = e.target as HTMLInputElement;
    filterPosts(target.value);
  });
</script>
